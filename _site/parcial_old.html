<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eb2023 - Parcial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">eb2023</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text"><i class="fa-solid fa-home" aria-label="home"></i> Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cronograma.html">
 <span class="menu-text"><i class="fa-solid fa-calendar" aria-label="calendar"></i> Cronograma</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./programa.html">
 <span class="menu-text"><i class="fa-solid fa-code" aria-label="code"></i> Programa</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ejercicios.html">
 <span class="menu-text"><i class="fa-solid fa-dumbbell" aria-label="dumbbell"></i> Ejercicios</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Parcial</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><span class="math display">\[ \text{Beta: }f(\theta \mid a,b) = \frac{\Gamma(a + b)}{\Gamma(a)\Gamma(b)} ~ \theta^{~a-1} ~ (1-\theta)^{~b-1} ~ \text{, para } \theta \in (0,1) \]</span></p>
<p><span class="math display">\[ \text{Gamma: } f(\lambda \mid r,s) = \frac{r^s}{\Gamma(s)} ~ \lambda^{~s-1} e^{-r \lambda} ~ \text{, para } \lambda &gt;0 \]</span></p>
<p><span class="math display">\[ \text{Binomial: } f(y \mid N,\theta) = {N \choose y}   \theta^{~y} ~ (1-\theta)^{~N-y}  ~ \text{, para } y=0,1,2,...,N \]</span></p>
<p><span class="math display">\[ \text{Poisson: } f(y \mid \lambda) = \frac{\lambda^y~e^{-\lambda}}{y!} ~ \text{, para } y=0,1,2,... \]</span></p>
<ol type="1">
<li>Considerar un modelo beta-binomial con datos y = (y_1, …, y_n), donde y_i = 1 si la variable i es un éxito y 0 en si es un fracaso. Asumir que la distribución a priori para la probabilidad de éxito theta es una beta(a,b).</li>
</ol>
<ul>
<li>Encontrar la distribución posterior para <span class="math inline">\(\theta\)</span>.</li>
<li>Suponer un dataset con <span class="math inline">\(n=10\)</span> observaciones, 3 de las cuáles son éxitosy asumir un prior beta(2,2). Graficar la distribución posterior para y calcular la probabilidad de que <span class="math inline">\(theta\)</span> sea menor que 0.4.</li>
</ul>
<ol type="1">
<li>Suponer una muestra y = (y_1, …, y_n) donde y_i ~ Poisson(theta) para i=1,…,n.&nbsp;Asumir un prior gamma para theta con parámetro shape a y parámetros rate b.</li>
</ol>
<ul>
<li>Usar la aproximación de grilla para calcular la distribución posterior para theta usando una grilla uniforme de 100 puntos entre 0 y 10.</li>
<li>Ahora suponer que hay una nueva observación y_{n+1} = 3. Usar la distribución posterior del ítem anterior para calcular la nueva distribución posterior para theta usando la aproximación de grilla con la misma grilla que antes.</li>
<li>Discutir la secuencialidad en inferencia bayesiana.</li>
<li>Con esta nueva distribución posterior para theta, encontrar la distribución posterior predictive usando simulaciones. Es decir, la distribución de observaciones que se derivan de esa distribución posterior.</li>
</ul>
<ol type="1">
<li></li>
</ol>
<p>Problem 1: Prior and Posterior Predictive Checks Consider a dataset y = (y_1, …, y_n) where y_i ~ Binomial(5, theta) for i=1,…,n.&nbsp;Assume a beta prior distribution for theta with parameters a = 2 and b = 2.</p>
<ol type="a">
<li>Using a grid approximation approach with a uniform grid of 100 points between 0 and 1, calculate the posterior distribution for theta.</li>
<li>Generate 1000 samples from the posterior distribution of theta, and use these samples to simulate 1000 new datasets of size n = 10.</li>
<li>Perform a prior predictive check and posterior predictive check for the original dataset y, and discuss your findings.</li>
</ol>
<p>Problem 3: Sequential Bayesian Updating Consider a dataset y = (y_1, …, y_n) where y_i ~ Binomial(10, theta) for i=1,…,n.&nbsp;Assume a beta prior distribution for theta with parameters a = 2 and b = 2.</p>
<ol type="a">
<li>Using a grid approximation approach with a uniform grid of 100 points between 0 and 1, calculate the posterior distribution for theta for the first 5 observations y_1, …, y_5.</li>
<li>Now suppose you observe a new data point y_6 = 8. Using the posterior distribution from part (a) as the prior, calculate the new posterior distribution for theta using a grid approximation approach with the same grid as before.</li>
<li>Repeat part (b) for each subsequent observation y_7, …, y_n.&nbsp;Discuss how the posterior distribution changes as more data is observed, and how this relates to the concept of sequential Bayesian updating.</li>
</ol>
<p>Problem 1: Grid Approximation and Sampling the Posterior Consider a dataset y = (y_1, …, y_n) where y_i ~ Bernoulli(theta) for i=1,…,n.&nbsp;Assume a beta prior distribution for theta with parameters a = 1 and b = 1.</p>
<ol type="a">
<li>Using a grid approximation approach with a uniform grid of 100 points between 0 and 1, calculate the posterior distribution for theta.</li>
</ol>
<section id="set-up-the-data-and-prior-parameters" class="level1">
<h1>Set up the data and prior parameters</h1>
<p>y &lt;- c(1, 0, 1, 1, 0, 1, 0, 0, 1, 1) n &lt;- length(y) a &lt;- 1 b &lt;- 1</p>
</section>
<section id="set-up-the-grid" class="level1">
<h1>Set up the grid</h1>
<p>theta_grid &lt;- seq(0, 1, length.out = 100)</p>
</section>
<section id="calculate-the-likelihood-for-each-value-of-theta" class="level1">
<h1>Calculate the likelihood for each value of theta</h1>
<p>likelihood &lt;- ______________________________</p>
</section>
<section id="calculate-the-unnormalized-posterior" class="level1">
<h1>Calculate the unnormalized posterior</h1>
<p>unnormalized_posterior &lt;- ___________________________</p>
</section>
<section id="normalize-the-posterior" class="level1">
<h1>Normalize the posterior</h1>
<p>posterior &lt;- _________________________</p>
</section>
<section id="plot-the-posterior-distribution" class="level1">
<h1>Plot the posterior distribution</h1>
<p>plot(theta_grid, posterior, type = “l”, xlab = “theta”, ylab = “Density”)</p>
<ol start="2" type="a">
<li>Using a Metropolis-Hastings algorithm with a normal proposal distribution, sample from the posterior distribution for theta using the dataset y = (1, 0, 1, 1, 0, 1, 0, 0, 1, 1).</li>
</ol>
</section>
<section id="define-the-log-likelihood-function" class="level1">
<h1>Define the log-likelihood function</h1>
<p>log_likelihood &lt;- function(theta, y) { sum(dbinom(y, 1, theta, log = TRUE)) }</p>
</section>
<section id="define-the-log-prior-function" class="level1">
<h1>Define the log-prior function</h1>
<p>log_prior &lt;- function(theta, a, b) { dbeta(theta, a, b, log = TRUE) }</p>
</section>
<section id="define-the-log-posterior-function" class="level1">
<h1>Define the log-posterior function</h1>
<p>log_posterior &lt;- function(theta, y, a, b) { log_likelihood(theta, y) + log_prior(theta, a, b) }</p>
</section>
<section id="set-the-initial-value-for-theta-and-the-number-of-iterations" class="level1">
<h1>Set the initial value for theta and the number of iterations</h1>
<p>theta_init &lt;- 0.5 n_iter &lt;- 10000</p>
</section>
<section id="define-the-standard-deviation-of-the-proposal-distribution" class="level1">
<h1>Define the standard deviation of the proposal distribution</h1>
<p>sd_proposal &lt;- 0.1</p>
</section>
<section id="create-a-vector-to-store-the-samples" class="level1">
<h1>Create a vector to store the samples</h1>
<p>theta_samples &lt;- numeric(n_iter)</p>
</section>
<section id="set-the-first-value-to-the-initial-value" class="level1">
<h1>Set the first value to the initial value</h1>
<p>theta_samples[1] &lt;- theta_init</p>
</section>
<section id="define-the-acceptance-rate" class="level1">
<h1>Define the acceptance rate</h1>
<p>acceptance_rate &lt;- 0</p>
</section>
<section id="run-the-metropolis-hastings-algorithm" class="level1">
<h1>Run the Metropolis-Hastings algorithm</h1>
<p>for (i in 2:n_iter) { # Sample from the proposal distribution theta_proposal &lt;- rnorm(1, theta_samples[i-1], sd_proposal)</p>
<p># Calculate the acceptance probability log_accept_prob &lt;- min(0, log_posterior(theta_proposal, y, a, b) - log_posterior(theta_samples[i-1], y, a, b)) accept_prob &lt;- exp(log_accept_prob)</p>
<p># Accept or reject the proposal if (runif(1) &lt; accept_prob) { theta_samples[i] &lt;- theta_proposal acceptance_rate &lt;- acceptance_rate + 1/n_iter } else { theta_samples[i] &lt;- theta_samples[i-1] } }</p>
</section>
<section id="plot-the-posterior-distribution-1" class="level1">
<h1>Plot the posterior distribution</h1>
<p>hist(theta_samples, breaks = 30, freq = FALSE, xlab = “theta”, main = “Posterior Distribution”)</p>
<p>Problem 3: Posterior Predictive Checks Consider a dataset y = (y_1, …, y_n) where y_i ~ Poisson(lambda) for i=1,…,n.&nbsp;Assume a gamma(2, 1) prior distribution for lambda.</p>
<ol type="a">
<li>Calculate the posterior predictive distribution for a new data point y_{n+1} using the dataset y = (1, 3, 0, 2, 1, 5, 2, 3, 1, 2).</li>
</ol>
</section>
<section id="set-up-the-data-and-prior-parameters-1" class="level1">
<h1>Set up the data and prior parameters</h1>
<p>y &lt;- c(1, 3, 0, 2, 1, 5, 2, 3, 1, 2) n &lt;- length(y) a &lt;- 2 b &lt;- 1</p>
</section>
<section id="set-up-the-grid-1" class="level1">
<h1>Set up the grid</h1>
<p>lambda_grid &lt;- seq(0, 20, length.out = 1000)</p>
</section>
<section id="calculate-the-unnormalized-posterior-1" class="level1">
<h1>Calculate the unnormalized posterior</h1>
<p>unnormalized_posterior &lt;- dgamma(lambda_grid, a + sum(y), b + n)</p>
</section>
<section id="normalize-the-posterior-1" class="level1">
<h1>Normalize the posterior</h1>
<p>posterior &lt;- unnormalized_posterior / sum(unnormalized_posterior)</p>
</section>
<section id="calculate-the-posterior-predictive-distribution-for-a-new-data-point" class="level1">
<h1>Calculate the posterior predictive distribution for a new data point</h1>
<p>posterior_predictive &lt;- dpois(y = 1, lambda = lambda_grid) * posterior</p>
</section>
<section id="calculate-the-posterior-predictive-distribution-for-a-new-data-point-1" class="level1">
<h1>Calculate the posterior predictive distribution for a new data point</h1>
<p>posterior_predictive &lt;- dpois(y = 1, lambda = lambda_grid) * posterior</p>
</section>
<section id="calculate-the-predictive-mean-and-variance" class="level1">
<h1>Calculate the predictive mean and variance</h1>
<p>predictive_mean &lt;- sum(posterior_predictive * lambda_grid) predictive_var &lt;- sum(posterior_predictive * (lambda_grid - predictive_mean)^2)</p>
</section>
<section id="print-the-results" class="level1">
<h1>Print the results</h1>
<p>cat(“Predictive mean:”, predictive_mean, “”) cat(“Predictive variance:”, predictive_var, “”)</p>
<ol start="2" type="a">
<li>Perform a posterior predictive check by generating 1000 new datasets from the posterior predictive distribution and calculating the proportion of datasets for which the sum of the new data points is greater than or equal to the sum of the original data points.</li>
</ol>
</section>
<section id="generate-1000-new-datasets-from-the-posterior-predictive-distribution" class="level1">
<h1>Generate 1000 new datasets from the posterior predictive distribution</h1>
<p>n_sims &lt;- 1000 new_data &lt;- rpois(n = n_sims, lambda = rnorm(n_sims, predictive_mean, sqrt(predictive_var)))</p>
</section>
<section id="calculate-the-sum-of-the-new-data-points-for-each-simulated-dataset" class="level1">
<h1>Calculate the sum of the new data points for each simulated dataset</h1>
<p>new_data_sum &lt;- apply(new_data, 2, sum)</p>
</section>
<section id="calculate-the-proportion-of-datasets-for-which-the-sum-of-the-new-data-points-is-greater-than-or-equal-to-the-sum-of-the-original-data-points" class="level1">
<h1>Calculate the proportion of datasets for which the sum of the new data points is greater than or equal to the sum of the original data points</h1>
<p>prop_greater_or_equal &lt;- mean(new_data_sum &gt;= sum(y))</p>
</section>
<section id="print-the-results-1" class="level1">
<h1>Print the results</h1>
<p>cat(“Proportion of datasets for which the sum of the new data points is greater than or equal to the sum of the original data points:”, prop_greater_or_equal, “”)</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>